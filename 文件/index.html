
<html>
  <head>
    <meta charset="utf-8" />
    <title>文件拖拽</title>
  </head>
  <body>
    <img id="img" src="" />
    <input id="file" type="file" />
    
    <div id="dropbox">拖拽</div>
  </body>
  <script src="https://cdn.staticfile.org/jquery/1.10.2/jquery.min.js"></script>
  <script>
    function transferImgToBase64(files, cb) {
      if(typeof FileReader === 'undefined') {
        alert('您的浏览器版本不支持图片上传，请升级或者更换浏览器')
        return false
      }
      let reader = new FileReader()
      reader.readAsDataURL(files[0])
      reader.onload = e => {
        cb ? cb(e.target.result) : null
      }
    }
    $('#file').change(e=> {
      const files = e.target.files || e.dataTransfer.files;
      debugger
      // const objectURL = window.URL.createObjectURL(files[0]);
      // $('#img').attr('src', objectURL) // 这两行代码无功无过好像
      transferImgToBase64(files, res => {
        console.log('转码后', res)
        $('#img').attr('src', res)
      })
    })

    const dropbox = $('#dropbox');
    // jQuery的监听事件用on，不用addEventListener
    dropbox.on({
      // 阻止dragenter和dragover事件的默认行为
      dragenter: dragenter,
      dragover: dragover,
      drop: drop
    })

    function dragenter(e) {
      e.stopPropagation();
      e.preventDefault();
    }
    function dragover(e) {
      e.stopPropagation();
      e.preventDefault();
    }

    function drop(e) {
      e.stopPropagation();
      e.preventDefault();
      // 在jQuery里面,得来originalEvent才拿得到
      const files = e.originalEvent.dataTransfer.files;
    }

  </script>
</html>